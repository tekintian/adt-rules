[ADT 3]
! Version: 2025-12-11T17:45:17
! Checksum: abcd
! Title: 屏蔽百度首页推广广告（通用版）
! Match: ^https?://(www\.)?baidu\.com/.*$
! Description: 基于通用特征屏蔽百度首页推广广告

(function() {
    // 等待DOM加载完成
    document.addEventListener('DOMContentLoaded', function() {
        // 广告元素选择器（基于通用特征，避免随机类名）
        const adSelectors = [
            '[data-tuiguang]',         // 广告文字标识（最可靠）
            'div[data-placeid]',       // 广告位置标识（通用特征）
            'div.cr-content',          // 右侧广告容器（通用类名）
            'div.result-op',           // 搜索结果广告容器（通用类名）
            '.ec-tuiguang'             // 推广标识
        ];
        
        // 移除广告元素的函数
        const removeAds = () => {
            adSelectors.forEach(selector => {
                const elements = document.querySelectorAll(selector);
                elements.forEach(element => {
                    // 如果是广告标识元素，移除其整个广告容器
                    if (element.hasAttribute('data-tuiguang')) {
                        // 查找包含data-placeid的祖先容器（最外层广告容器）
                        const adContainer = element.closest('div[data-placeid], div.cr-content, div.result-op');
                        if (adContainer) {
                            adContainer.remove();
                        }
                    } else {
                        // 直接移除广告容器
                        element.remove();
                    }
                });
            });
        };
        
        // 初始移除广告
        removeAds();
        
        // 监控DOM变化，处理动态加载的广告
        const observer = new MutationObserver(function(mutations) {
            mutations.forEach(function(mutation) {
                mutation.addedNodes.forEach(function(node) {
                    // 检查是否为广告元素或包含广告元素
                    if (node.nodeType === 1) { // 元素节点
                        if (node.hasAttribute('data-tuiguang') ||    // 直接是广告标识
                            node.hasAttribute('data-placeid') ||     // 直接是广告容器
                            node.classList.contains('cr-content') || // 直接是右侧广告容器
                            node.classList.contains('result-op') ||  // 直接是搜索结果广告
                            node.querySelector('[data-tuiguang]')) { // 包含广告标识
                            removeAds();
                        }
                    }
                });
            });
        });
        
        // 启动观察器
        observer.observe(document.body, {
            childList: true,
            subtree: true
        });
    });
})();